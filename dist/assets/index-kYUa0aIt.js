import{o as y,s as j,n as l,i as w,k as P,l as C,u as E,r as v,t as M,j as e}from"./index-D3NPveco.js";import{C as N}from"./config-drawer-BOZOmPdm.js";import{u as T,H as D,S as k}from"./search-DGDFI4xk.js";import{M as R}from"./main-M3t2zLu9.js";import{P as A}from"./profile-dropdown-TIbTcRk6.js";import{T as F}from"./theme-switch-Cc1gv-2A.js";import{a as Q,c as q,U as z,b as B,d as H}from"./users-table-CBkuWSwr.js";import{a as K}from"./api-client-QQq-wIhq.js";import"./index-CJw4kmEm.js";import"./index-Bs54XTPB.js";import"./index-CUhw26c5.js";import"./index-DVt2Q-7a.js";import"./index-BWC4LGWb.js";import"./index-Dk6xqxMW.js";import"./index-Q8mwsH7E.js";import"./index-hhb2EvcI.js";import"./layout-provider-8bzNZRTL.js";import"./dropdown-menu-BCYxb1oP.js";import"./command-CImZOo8a.js";import"./index-CLVqzXn2.js";import"./index-Cqg7MwP1.js";import"./check-B4ZP-tm0.js";import"./separator-fNd7YUqQ.js";import"./index-CsCFIuwR.js";import"./form-X0r0zn8D.js";import"./show-submitted-data-UgpERGAk.js";import"./input-6qCb2yCg.js";import"./password-input-CHpQkyAj.js";import"./eye-BM5G7BLg.js";import"./bulk-actions-C3o989pF.js";import"./select-B8V2QOwk.js";import"./chevron-down-BLvtA-0r.js";import"./badge-Kp1b-HXG.js";import"./alert-DbllP8qK.js";import"./card-BdMccGcl.js";import"./toolbar-Bj-k75sj.js";import"./react-icons.esm-3kbhK4Wj.js";import"./popover-Cthf4V8P.js";import"./collapsible-Be8Qetm1.js";import"./skeleton-B5rHEncB.js";import"./format-DMm6umYn.js";import"./index-BzvGSFj6.js";import"./trash-2-D45Pbrb2.js";import"./get-row-serial-lFSYfpsv.js";const L=y({message:j().optional(),data:y({data:w(Q),current_page:l().int().nonnegative(),per_page:l().int().positive(),total:l().int().nonnegative(),last_page:l().int().nonnegative().optional(),next_page_url:j().nullable().optional(),prev_page_url:j().nullable().optional()})});async function Y({page:s=1,perPage:t=10,sort:a="desc",search:r}={}){const o=await K.get("/api/admin/users",{params:{page:s,per_page:t,sort:a,...r?.trim()?{s:r.trim()}:{}}}),i=L.safeParse(o.data);if(!i.success)throw new Error("Unable to parse users response.");const{data:{data:g,current_page:n,per_page:u,total:d,last_page:p,next_page_url:x,prev_page_url:c},message:h}=i.data;return{users:g.map(q),pagination:{page:n,perPage:u,total:d,lastPage:p,hasNext:!!x,hasPrevious:!!c},rawMessage:h}}const G=["admin","users"];function I({page:s,perPage:t,sort:a,search:r,enabled:o=!0}){return T({queryKey:[...G,{page:s??1,perPage:t??10,sort:a??"desc",search:r??""}],queryFn:()=>Y({page:s,perPage:t,sort:a,search:r}),placeholderData:P,enabled:o,staleTime:1e3*30})}const U=C("/_authenticated/users/");function J(){const s=U.useSearch(),t=U.useNavigate(),{t:a}=E(),r=s.page??1,o=s.pageSize??10,i=s.sort==="asc"?"asc":"desc",g=typeof s.s=="string"&&s.s.trim().length>0?s.s:void 0,{data:n,isLoading:u,isFetching:d,error:p}=I({page:r,perPage:o,sort:i,search:g});v.useEffect(()=>{p instanceof Error&&M.error(p.message)},[p]);const x=n?.users??[],c=n?.pagination.total??0,h=n?.pagination.lastPage??(o>0?Math.max(1,Math.ceil(c/o)):1),m=v.useMemo(()=>[{id:"createdAt",desc:i!=="asc"}],[i]),S=v.useCallback(f=>{const _=(typeof f=="function"?f(m):f)[0]?.desc===!1?"asc":"desc";t({search:b=>({...b,sort:_==="desc"?void 0:_})})},[t,m]);return e.jsxs(z,{children:[e.jsxs(D,{fixed:!0,children:[e.jsx(k,{}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(F,{}),e.jsx(N,{}),e.jsx(A,{})]})]}),e.jsxs(R,{children:[e.jsx("div",{className:"mb-4 flex flex-wrap items-center justify-between space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:a("users.page.title","User List")}),e.jsx("p",{className:"text-muted-foreground",children:a("users.page.description","Manage your users and their roles here.")})]})}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-y-0 lg:space-x-12",children:e.jsx(B,{data:x,total:c,pageCount:h,isLoading:u,isFetching:d,sorting:m,onSortingChange:S,search:s,navigate:t})})]}),e.jsx(H,{})]})}const ze=J;export{ze as component};
