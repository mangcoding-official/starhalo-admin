import{o as y,s as j,n as l,i as w,k as P,l as C,u as E,r as v,t as M,j as e}from"./index-DpFIowpL.js";import{C as N}from"./config-drawer-B4XE-z16.js";import{u as T,H as D,S as k}from"./search-BvEeOfrC.js";import{M as R}from"./main-D_udXDVz.js";import{P as A}from"./profile-dropdown-BmwDFcOr.js";import{T as F}from"./theme-switch-BhpkALYa.js";import{a as Q,c as q,U as z,b as B,d as H}from"./users-table-N-jffwJr.js";import{a as K}from"./api-client-BW-LdrQ3.js";import"./index-guKGFKkA.js";import"./index-CamZVnv5.js";import"./index-BQzvqra1.js";import"./index-B6dlZhJW.js";import"./index-BaIXyGzm.js";import"./index-Dmvv9RCI.js";import"./index-Ww56rzXN.js";import"./index-BAlg5sud.js";import"./layout-provider-DBFuSN2z.js";import"./dropdown-menu-DRiR6jwX.js";import"./command-CoBbvaYx.js";import"./index-WqzAutaT.js";import"./index-CnZtZjNd.js";import"./check-BX9hbEju.js";import"./separator-DTu0TdCe.js";import"./index-BfJEAUIy.js";import"./form-CBubDuqC.js";import"./show-submitted-data-jtP7JnYi.js";import"./input-D0A8Fyyz.js";import"./password-input-BZoCohvp.js";import"./eye-BxA0sPvX.js";import"./bulk-actions-C3LAWHN-.js";import"./select-DVQuR1AC.js";import"./chevron-down-DeCfgfqp.js";import"./badge-CD_jltcm.js";import"./alert-DNMLCN9A.js";import"./card-sEkhbL22.js";import"./toolbar-B_LLMJ9j.js";import"./react-icons.esm-B7UIG0CX.js";import"./popover-C6gdBBRN.js";import"./collapsible-DGiuI4St.js";import"./skeleton-BxQgEnUR.js";import"./format-DMm6umYn.js";import"./index-CQo1UXKH.js";import"./trash-2-CvZ-Ud7z.js";import"./get-row-serial-lFSYfpsv.js";const L=y({message:j().optional(),data:y({data:w(Q),current_page:l().int().nonnegative(),per_page:l().int().positive(),total:l().int().nonnegative(),last_page:l().int().nonnegative().optional(),next_page_url:j().nullable().optional(),prev_page_url:j().nullable().optional()})});async function Y({page:s=1,perPage:t=10,sort:a="desc",search:r}={}){const o=await K.get("/api/admin/users",{params:{page:s,per_page:t,sort:a,...r?.trim()?{s:r.trim()}:{}}}),i=L.safeParse(o.data);if(!i.success)throw new Error("Unable to parse users response.");const{data:{data:g,current_page:n,per_page:u,total:d,last_page:p,next_page_url:x,prev_page_url:c},message:h}=i.data;return{users:g.map(q),pagination:{page:n,perPage:u,total:d,lastPage:p,hasNext:!!x,hasPrevious:!!c},rawMessage:h}}const G=["admin","users"];function I({page:s,perPage:t,sort:a,search:r,enabled:o=!0}){return T({queryKey:[...G,{page:s??1,perPage:t??10,sort:a??"desc",search:r??""}],queryFn:()=>Y({page:s,perPage:t,sort:a,search:r}),placeholderData:P,enabled:o,staleTime:1e3*30})}const U=C("/_authenticated/users/");function J(){const s=U.useSearch(),t=U.useNavigate(),{t:a}=E(),r=s.page??1,o=s.pageSize??10,i=s.sort==="asc"?"asc":"desc",g=typeof s.s=="string"&&s.s.trim().length>0?s.s:void 0,{data:n,isLoading:u,isFetching:d,error:p}=I({page:r,perPage:o,sort:i,search:g});v.useEffect(()=>{p instanceof Error&&M.error(p.message)},[p]);const x=n?.users??[],c=n?.pagination.total??0,h=n?.pagination.lastPage??(o>0?Math.max(1,Math.ceil(c/o)):1),m=v.useMemo(()=>[{id:"createdAt",desc:i!=="asc"}],[i]),S=v.useCallback(f=>{const _=(typeof f=="function"?f(m):f)[0]?.desc===!1?"asc":"desc";t({search:b=>({...b,sort:_==="desc"?void 0:_})})},[t,m]);return e.jsxs(z,{children:[e.jsxs(D,{fixed:!0,children:[e.jsx(k,{}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(F,{}),e.jsx(N,{}),e.jsx(A,{})]})]}),e.jsxs(R,{children:[e.jsx("div",{className:"mb-4 flex flex-wrap items-center justify-between space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:a("users.page.title","User List")}),e.jsx("p",{className:"text-muted-foreground",children:a("users.page.description","Manage your users and their roles here.")})]})}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-y-0 lg:space-x-12",children:e.jsx(B,{data:x,total:c,pageCount:h,isLoading:u,isFetching:d,sorting:m,onSortingChange:S,search:s,navigate:t})})]}),e.jsx(H,{})]})}const ze=J;export{ze as component};
