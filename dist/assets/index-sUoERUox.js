import{o as y,s as j,n as l,i as w,k as P,l as C,u as E,r as v,t as M,j as e}from"./index-BPSZ23yK.js";import{C as N}from"./config-drawer-CJ7gz8yj.js";import{u as T,H as D,S as k}from"./search-BH8cG_Mc.js";import{M as R}from"./main-DDuuTw6d.js";import{P as A}from"./profile-dropdown-ck0BZhfN.js";import{T as F}from"./theme-switch-COF_DH2B.js";import{a as Q,c as q,U as z,b as B,d as H}from"./users-table-DwVlzUpg.js";import{a as K}from"./api-client-m-KTob-k.js";import"./index-DjD6NQHy.js";import"./index-E6AtwoD-.js";import"./index-l18ud2wc.js";import"./index-D3o07efQ.js";import"./index-CO7e1cEs.js";import"./index-BzljWo5j.js";import"./index-CcqO3QxQ.js";import"./index-_hsB4uYA.js";import"./layout-provider-ClEEKa2B.js";import"./dropdown-menu-CywYzuBz.js";import"./command-Bn0Ghmfc.js";import"./index-CapyU3Ll.js";import"./index-q5h3T6pY.js";import"./check-DdWDy1wJ.js";import"./separator-DC7n6DXS.js";import"./index-DkEBYZ69.js";import"./form-CtqYgiyz.js";import"./show-submitted-data-CQhPAlMe.js";import"./input-DuMOtWk2.js";import"./password-input-Op16TeTK.js";import"./eye-1J8epcHx.js";import"./bulk-actions-Bt9B4Wm7.js";import"./select-UXgEQtMQ.js";import"./chevron-down-Ew3f4PwD.js";import"./badge-taik_GfK.js";import"./alert-DZ4e5KYl.js";import"./card-BaqllfZD.js";import"./toolbar-CBjoaQVP.js";import"./react-icons.esm-CfnrlJZh.js";import"./popover-MHnAXzd2.js";import"./collapsible-C66S4MlE.js";import"./skeleton-D2l6--hT.js";import"./format-DMm6umYn.js";import"./index-Dgq280gv.js";import"./trash-2-BFlGjZhg.js";import"./get-row-serial-lFSYfpsv.js";const L=y({message:j().optional(),data:y({data:w(Q),current_page:l().int().nonnegative(),per_page:l().int().positive(),total:l().int().nonnegative(),last_page:l().int().nonnegative().optional(),next_page_url:j().nullable().optional(),prev_page_url:j().nullable().optional()})});async function Y({page:s=1,perPage:t=10,sort:a="desc",search:r}={}){const o=await K.get("/api/admin/users",{params:{page:s,per_page:t,sort:a,...r?.trim()?{s:r.trim()}:{}}}),i=L.safeParse(o.data);if(!i.success)throw new Error("Unable to parse users response.");const{data:{data:g,current_page:n,per_page:u,total:d,last_page:p,next_page_url:x,prev_page_url:c},message:h}=i.data;return{users:g.map(q),pagination:{page:n,perPage:u,total:d,lastPage:p,hasNext:!!x,hasPrevious:!!c},rawMessage:h}}const G=["admin","users"];function I({page:s,perPage:t,sort:a,search:r,enabled:o=!0}){return T({queryKey:[...G,{page:s??1,perPage:t??10,sort:a??"desc",search:r??""}],queryFn:()=>Y({page:s,perPage:t,sort:a,search:r}),placeholderData:P,enabled:o,staleTime:1e3*30})}const U=C("/_authenticated/users/");function J(){const s=U.useSearch(),t=U.useNavigate(),{t:a}=E(),r=s.page??1,o=s.pageSize??10,i=s.sort==="asc"?"asc":"desc",g=typeof s.s=="string"&&s.s.trim().length>0?s.s:void 0,{data:n,isLoading:u,isFetching:d,error:p}=I({page:r,perPage:o,sort:i,search:g});v.useEffect(()=>{p instanceof Error&&M.error(p.message)},[p]);const x=n?.users??[],c=n?.pagination.total??0,h=n?.pagination.lastPage??(o>0?Math.max(1,Math.ceil(c/o)):1),m=v.useMemo(()=>[{id:"createdAt",desc:i!=="asc"}],[i]),S=v.useCallback(f=>{const _=(typeof f=="function"?f(m):f)[0]?.desc===!1?"asc":"desc";t({search:b=>({...b,sort:_==="desc"?void 0:_})})},[t,m]);return e.jsxs(z,{children:[e.jsxs(D,{fixed:!0,children:[e.jsx(k,{}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(F,{}),e.jsx(N,{}),e.jsx(A,{})]})]}),e.jsxs(R,{children:[e.jsx("div",{className:"mb-4 flex flex-wrap items-center justify-between space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:a("users.page.title","User List")}),e.jsx("p",{className:"text-muted-foreground",children:a("users.page.description","Manage your users and their roles here.")})]})}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-y-0 lg:space-x-12",children:e.jsx(B,{data:x,total:c,pageCount:h,isLoading:u,isFetching:d,sorting:m,onSortingChange:S,search:s,navigate:t})})]}),e.jsx(H,{})]})}const ze=J;export{ze as component};
